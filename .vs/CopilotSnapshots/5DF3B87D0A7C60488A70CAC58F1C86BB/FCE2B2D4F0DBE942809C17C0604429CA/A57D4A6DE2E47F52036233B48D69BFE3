using System.Data;
using ExcelReader.RyanW84.Models;
using ExcelReader.RyanW84.Abstractions.Base;

namespace ExcelReader.RyanW84.Abstractions;

// ================================
// FILE READER INTERFACES
// ================================

/// <summary>
/// Interface for Excel file reading operations
/// </summary>
public interface IExcelReader : IFileReader<DataTable>
{
    /// <summary>
    /// Gets available worksheet names in the Excel file
    /// </summary>
    /// <param name="filePath">Path to the Excel file</param>
    /// <returns>List of worksheet names</returns>
    Task<IEnumerable<string>> GetWorksheetsAsync(string filePath);
}

/// <summary>
/// Interface for PDF file reading operations
/// </summary>
public interface IPdfReader : IFileReader<Dictionary<string, string>>
{
    /// <summary>
    /// Reads form fields from PDF
    /// </summary>
    /// <param name="filePath">Path to the PDF file</param>
    /// <returns>Dictionary of form field names and values</returns>
    Task<Dictionary<string, string>> ReadFormFieldsAsync(string filePath);
}

/// <summary>
/// Interface for CSV file reading operations
/// </summary>
public interface ICsvReader : IFileReader<DataTable>
{
    /// <summary>
    /// Gets the number of columns in the CSV file
    /// </summary>
    /// <param name="filePath">Path to the CSV file</param>
    /// <returns>Number of columns</returns>
    Task<int> GetColumnCountAsync(string filePath);
}

/// <summary>
/// Interface for any Excel reading operations
/// </summary>
public interface IAnyExcelReader
{
    Task<DataTable> ReadFromExcelAsync();
    DataTable ReadFromExcel();
}

/// <summary>
/// Interface for CSV file reading operations
/// </summary>
public interface ICsvFileReader
{
    Task<List<string[]>> ReadCsvFile();
}

/// <summary>
/// Interface for PDF table reading operations
/// </summary>
public interface IPdfTableReader 
{ 
    Task<List<string[]>> ReadPdfFileAsync();
    List<string[]> ReadPdfFile();
    
    /// <summary>
    /// Converts the PDF data (list of string arrays) to a DataTable
    /// </summary>
    /// <param name="pdfData">The PDF data as list of string arrays</param>
    /// <returns>A DataTable containing the PDF data</returns>
    Task<System.Data.DataTable> ConvertToDataTableAsync(List<string[]> pdfData);
}

/// <summary>
/// Interface for PDF form reading operations
/// </summary>
public interface IPdfFormReader
{
    Task<Dictionary<string, string>> ReadFormFieldsAsync(string filePath);
    Dictionary<string, string> ReadFormFields(string filePath);
}

/// <summary>
/// Interface for PDF form writing operations
/// </summary>
public interface IPdfFormWriter
{
    Task WriteFormFieldsAsync(string filePath, Dictionary<string, string> fieldValues);
    void WriteFormFields(string filePath, Dictionary<string, string> fieldValues);
}

// ================================
// REPOSITORY INTERFACES
// ================================

/// <summary>
/// Specific repository interface for ExcelBeginner entities
/// </summary>
public interface IExcelBeginnerRepository : IRepository<ExcelBeginner>
{
    Task<IEnumerable<ExcelBeginner>> GetByNameAsync(string name);
    Task<IEnumerable<ExcelBeginner>> GetByAgeRangeAsync(int minAge, int maxAge);
}

// ================================
// SERVICE INTERFACES
// ================================

/// <summary>
/// Interface for data conversion operations
/// </summary>
public interface IDataConverter<TSource, TTarget>
{
    TTarget Convert(TSource source);
    Task<TTarget> ConvertAsync(TSource source);
}

/// <summary>
/// Interface for file path management
/// </summary>
public interface IFilePathService
{
    string GetFilePath(FileType fileType, string? customDefault = null);
    void ValidateFilePath(string filePath, FileType fileType);
    bool IsValidPath(string filePath);
}

/// <summary>
/// Interface for Excel database operations
/// </summary>
public interface IExcelDatabaseService
{
    Task WriteAsync(Dictionary<string, string> fieldValues);
}

// ================================
// ENUMS
// ================================

/// <summary>
/// Enum for file types
/// </summary>
public enum FileType
{
    Excel,
    PDF,
    CSV,
    Generic
}